1.1,"SELECT r.room_number, p.name, a.admission_date FROM admission a JOIN room r ON r.room_number = a.room_number JOIN patient p ON p.patient_id = a.patient_id WHERE r.occupied = TRUE;"
1.2,"SELECT room_number AS 'Empty Rooms' FROM room WHERE occupied = FALSE;"
1.3,"SELECT r.room_number, p.name, a.admission_date FROM room r LEFT JOIN admission a ON a.room_number = r.room_number AND a.current = TRUE LEFT JOIN patient p ON p.patient_id = a.patient_id WHERE a.admission_id IS NULL OR a.current = TRUE;"
2.1,"SELECT * FROM patient;"
2.2,"SELECT p.patient_id, p.name FROM admission a JOIN patient p ON p.patient_id = a.patient_id WHERE a.current IS TRUE;"
2.3,"SELECT p.patient_id, p.name FROM patient p INNER JOIN admission a ON p.patient_id = a.patient_id INNER JOIN discharge d ON a.admission_id = d.admission_id WHERE d.completed_time BETWEEN '2022-08-01' AND '2022-09-20';"
2.4,"SELECT p.patient_id, p.name FROM patient p INNER JOIN admission a ON p.patient_id = a.patient_id WHERE a.admission_date BETWEEN '2023-03-21' AND '2023-03-22';"
2.5,"SELECT p.name, a.admission_id, d.diagnosis_name FROM admission a JOIN patient p ON p.patient_id = a.patient_id join diagnosis d on d.diagnosis_id = a.diagnosis_id WHERE p.patient_id = 1;"
2.6,"SELECT pt.name, a.admission_id, t.treatment_id, CASE WHEN t.med_id IS NOT NULL THEN m.med_name WHEN t.proc_id IS NOT NULL THEN p.proc_name END AS treatment_name FROM admission a LEFT JOIN patient pt on pt.patient_id = a.patient_id LEFT JOIN treatment t ON a.admission_id = t.admission_id LEFT JOIN medication m ON t.med_id = m.med_id LEFT JOIN procedures p ON t.proc_id = p.proc_id WHERE a.patient_id = 1 ORDER BY a.admission_date DESC , t.order_time ASC;"
3.1,"SELECT d.diagnosis_id, d.diagnosis_name, COUNT(*) AS occurrences FROM diagnosis d JOIN admission a ON d.diagnosis_id = a.diagnosis_id GROUP BY d.diagnosis_id ORDER BY occurrences DESC;"
3.2,"SELECT d.diagnosis_id, d.diagnosis_name, COUNT(*) AS occurrences FROM diagnosis d JOIN admission a ON d.diagnosis_id = a.diagnosis_id GROUP BY d.diagnosis_id ORDER BY occurrences DESC;"
3.3,"SELECT t.treatment_id, CASE WHEN t.med_id IS NOT NULL THEN m.med_name WHEN t.proc_id IS NOT NULL THEN p.proc_name END AS treatment_name, COUNT(*) AS occurences FROM admission a LEFT JOIN treatment t ON t.admission_id = a.admission_id LEFT JOIN medication m ON t.med_id = m.med_id LEFT JOIN procedures p ON t.proc_id = p.proc_id GROUP BY t.treatment_id , treatment_name ORDER BY occurences DESC;"
3.4,"SELECT p.name, d.diagnosis_id, d.diagnosis_name, COUNT(*) as total_occurrences FROM patient p JOIN admission a ON p.patient_id = a.patient_id JOIN diagnosis d ON a.diagnosis_id = d.diagnosis_id WHERE p.patient_id = (SELECT patient_id FROM admission GROUP BY patient_id ORDER BY COUNT(*) DESC LIMIT 1) GROUP BY p.name, d.diagnosis_id, d.diagnosis_name ORDER BY total_occurrences DESC;"
3.5,"SELECT p.name, CONCAT(e.lname, ', ', e.fname) AS doc_name FROM treatment t JOIN employee e ON e.employee_id = t.doctor_id JOIN admission a ON a.admission_id = t.admission_id JOIN patient p ON p.patient_id = a.patient_id WHERE t.treatment_id = 1;"
4.1,"SELECT CONCAT(e.lname, ', ', e.fname) AS name, e.job_type FROM employee e ORDER BY name ASC;"
4.2,"SELECT e.fname, e.lname, COUNT(*) AS admission_count FROM admission a JOIN patient p ON a.patient_id = p.patient_id JOIN employee e ON a.doctor_id = e.employee_id GROUP BY a.doctor_id HAVING admission_count >= 4 ORDER BY admission_count DESC;"
4.3,"SELECT e.lname, d.diagnosis_name, COUNT(*) AS diagnosis_count FROM admission a JOIN employee e ON a.doctor_id = e.employee_id JOIN diagnosis d ON a.diagnosis_id = d.diagnosis_id WHERE e.employee_id = 2 GROUP BY d.diagnosis_name ORDER BY diagnosis_count DESC;"
4.4,"SELECT e.lname, CASE WHEN m.med_name IS NOT NULL THEN m.med_name WHEN p.proc_name IS NOT NULL THEN p.proc_name END AS treatment_name, COUNT(*) AS treatment_count FROM treatment t JOIN employee e ON t.doctor_id = e.employee_id LEFT JOIN medication m ON t.med_id = m.med_id LEFT JOIN procedures p ON t.proc_id = p.proc_id WHERE e.employee_id = 2 GROUP BY treatment_name ORDER BY treatment_count DESC;"